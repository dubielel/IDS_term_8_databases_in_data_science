StmtText,StmtId,NodeId,Parent,PhysicalOp,LogicalOp,Argument,DefinedValues,EstimateRows,EstimateIO,EstimateCPU,AvgRowSize,TotalSubtreeCost,OutputList,Warnings,Type,Parallel,EstimateExecutions
"select
    id,
    productid,
    productname,
    categoryid,
    unitprice,
    (
        select avg(unitprice)
        from producthistory as t
        where t.categoryid = producthistory.categoryid
    ) as avgpricecategory,
    (
        select sum(unitprice)
        from producthistory as t
        where t.categoryid = producthistory.categoryid
    ) as sumpricecategory,
    (
        select avg(unitprice)
        from producthistory as t
        where t.productid = producthistory.productid
    ) as avgpriceproduct,
    (
        select sum(unitprice)
        from producthistory as t
        where t.productid = producthistory.productid
    ) as sumpriceproduct
from producthistory",1,1,0,,,1,,2310000,,,,107.91559,,,SELECT,false,
  |--Parallelism(Gather Streams),1,2,1,Parallelism,Gather Streams,,,2310000,0,7.725131,121,107.91559,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1005], [Expr1009], [Expr1013], [Expr1017]",,PLAN_ROW,true,1
"       |--Compute Scalar(DEFINE:([Expr1005]=[Expr1003], [Expr1009]=[Expr1007], [Expr1013]=[Expr1011], [Expr1017]=[Expr1015]))",1,3,2,Compute Scalar,Compute Scalar,"DEFINE:([Expr1005]=[Expr1003], [Expr1009]=[Expr1007], [Expr1013]=[Expr1011], [Expr1017]=[Expr1015])","[Expr1005]=[Expr1003], [Expr1009]=[Expr1007], [Expr1013]=[Expr1011], [Expr1017]=[Expr1015]",2310000,0,0.005775,121,100.18526,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1005], [Expr1009], [Expr1013], [Expr1017]",,PLAN_ROW,true,1
"            |--Hash Match(Right Outer Join, HASH:([t].[productid])=([northwind].[dbo].[producthistory].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid]=[northwind].[dbo].[producthistory].[productid]))",1,4,3,Hash Match,Right Outer Join,"HASH:([t].[productid])=([northwind].[dbo].[producthistory].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid]=[northwind].[dbo].[producthistory].[productid])",,2310000,0,0.4429605,121,100.17948,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1003], [Expr1007], [Expr1011], [Expr1015]",,PLAN_ROW,true,1
                 |--Compute Scalar(DEFINE:([Expr1015]=CASE WHEN [Expr1034]=(0) THEN NULL ELSE [Expr1035] END)),1,5,4,Compute Scalar,Compute Scalar,DEFINE:([Expr1015]=CASE WHEN [Expr1034]=(0) THEN NULL ELSE [Expr1035] END),[Expr1015]=CASE WHEN [Expr1034]=(0) THEN NULL ELSE [Expr1035] END,77,0,0,28,19.764006,"[t].[productid], [Expr1015]",,PLAN_ROW,true,1
"                 |    |--Hash Match(Aggregate, HASH:([t].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid] = [northwind].[dbo].[producthistory].[productid] as [t].[productid]) DEFINE:([Expr1034]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1035]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])))",1,6,5,Hash Match,Aggregate,"HASH:([t].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid] = [northwind].[dbo].[producthistory].[productid] as [t].[productid])","[Expr1034]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1035]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])",77,0,0.4122581,28,19.764006,"[t].[productid], [Expr1034], [Expr1035]",,PLAN_ROW,true,1
                 |         |--Clustered Index Scan(OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t])),1,7,6,Clustered Index Scan,Clustered Index Scan,OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t]),"[t].[productid], [t].[unitprice]",2310000,18.71646,0.63528925,20,19.351748,"[t].[productid], [t].[unitprice]",,PLAN_ROW,true,1
"                 |--Hash Match(Right Outer Join, HASH:([t].[productid])=([northwind].[dbo].[producthistory].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid]=[northwind].[dbo].[producthistory].[productid]))",1,8,4,Hash Match,Right Outer Join,"HASH:([t].[productid])=([northwind].[dbo].[producthistory].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid]=[northwind].[dbo].[producthistory].[productid])",,2310000,0,0.4429605,103,79.97251,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1003], [Expr1007], [Expr1011]",,PLAN_ROW,true,1
"                      |--Compute Scalar(DEFINE:([Expr1011]=CASE WHEN [Expr1036]=(0) THEN NULL ELSE [Expr1037]/CONVERT_IMPLICIT(decimal(19,0),[Expr1036],0) END))",1,9,8,Compute Scalar,Compute Scalar,"DEFINE:([Expr1011]=CASE WHEN [Expr1036]=(0) THEN NULL ELSE [Expr1037]/CONVERT_IMPLICIT(decimal(19,0),[Expr1036],0) END)","[Expr1011]=CASE WHEN [Expr1036]=(0) THEN NULL ELSE [Expr1037]/CONVERT_IMPLICIT(decimal(19,0),[Expr1036],0) END",77,0,0,28,19.764006,"[t].[productid], [Expr1011]",,PLAN_ROW,true,1
"                      |    |--Hash Match(Aggregate, HASH:([t].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid] = [northwind].[dbo].[producthistory].[productid] as [t].[productid]) DEFINE:([Expr1036]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1037]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])))",1,10,9,Hash Match,Aggregate,"HASH:([t].[productid]), RESIDUAL:([northwind].[dbo].[producthistory].[productid] as [t].[productid] = [northwind].[dbo].[producthistory].[productid] as [t].[productid])","[Expr1036]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1037]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])",77,0,0.4122581,28,19.764006,"[t].[productid], [Expr1036], [Expr1037]",,PLAN_ROW,true,1
                      |         |--Clustered Index Scan(OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t])),1,11,10,Clustered Index Scan,Clustered Index Scan,OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t]),"[t].[productid], [t].[unitprice]",2310000,18.71646,0.63528925,20,19.351748,"[t].[productid], [t].[unitprice]",,PLAN_ROW,true,1
"                      |--Hash Match(Right Outer Join, HASH:([t].[categoryid])=([northwind].[dbo].[producthistory].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid]=[northwind].[dbo].[producthistory].[categoryid]))",1,12,8,Hash Match,Right Outer Join,"HASH:([t].[categoryid])=([northwind].[dbo].[producthistory].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid]=[northwind].[dbo].[producthistory].[categoryid])",,2310000,0,0.4429307,86,59.765545,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1003], [Expr1007]",,PLAN_ROW,true,1
                           |--Compute Scalar(DEFINE:([Expr1007]=CASE WHEN [Expr1038]=(0) THEN NULL ELSE [Expr1039] END)),1,13,12,Compute Scalar,Compute Scalar,DEFINE:([Expr1007]=CASE WHEN [Expr1038]=(0) THEN NULL ELSE [Expr1039] END),[Expr1007]=CASE WHEN [Expr1038]=(0) THEN NULL ELSE [Expr1039] END,8,0,0,28,19.763966,"[t].[categoryid], [Expr1007]",,PLAN_ROW,true,1
"                           |    |--Hash Match(Aggregate, HASH:([t].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid] = [northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid]) DEFINE:([Expr1038]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1039]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])))",1,14,13,Hash Match,Aggregate,"HASH:([t].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid] = [northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid])","[Expr1038]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1039]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])",8,0,0.41221723,28,19.763966,"[t].[categoryid], [Expr1038], [Expr1039]",,PLAN_ROW,true,1
                           |         |--Clustered Index Scan(OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t])),1,15,14,Clustered Index Scan,Clustered Index Scan,OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t]),"[t].[categoryid], [t].[unitprice]",2310000,18.71646,0.63528925,20,19.351748,"[t].[categoryid], [t].[unitprice]",,PLAN_ROW,true,1
"                           |--Hash Match(Right Outer Join, HASH:([t].[categoryid])=([northwind].[dbo].[producthistory].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid]=[northwind].[dbo].[producthistory].[categoryid]))",1,16,12,Hash Match,Right Outer Join,"HASH:([t].[categoryid])=([northwind].[dbo].[producthistory].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid]=[northwind].[dbo].[producthistory].[categoryid])",,2310000,0,0.4429307,69,39.558647,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1003]",,PLAN_ROW,true,1
"                                |--Compute Scalar(DEFINE:([Expr1003]=CASE WHEN [Expr1040]=(0) THEN NULL ELSE [Expr1041]/CONVERT_IMPLICIT(decimal(19,0),[Expr1040],0) END))",1,17,16,Compute Scalar,Compute Scalar,"DEFINE:([Expr1003]=CASE WHEN [Expr1040]=(0) THEN NULL ELSE [Expr1041]/CONVERT_IMPLICIT(decimal(19,0),[Expr1040],0) END)","[Expr1003]=CASE WHEN [Expr1040]=(0) THEN NULL ELSE [Expr1041]/CONVERT_IMPLICIT(decimal(19,0),[Expr1040],0) END",8,0,0,28,19.763966,"[t].[categoryid], [Expr1003]",,PLAN_ROW,true,1
"                                |    |--Hash Match(Aggregate, HASH:([t].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid] = [northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid]) DEFINE:([Expr1040]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1041]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])))",1,18,17,Hash Match,Aggregate,"HASH:([t].[categoryid]), RESIDUAL:([northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid] = [northwind].[dbo].[producthistory].[categoryid] as [t].[categoryid])","[Expr1040]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice]), [Expr1041]=SUM([northwind].[dbo].[producthistory].[unitprice] as [t].[unitprice])",8,0,0.41221723,28,19.763966,"[t].[categoryid], [Expr1040], [Expr1041]",,PLAN_ROW,true,1
                                |         |--Clustered Index Scan(OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t])),1,19,18,Clustered Index Scan,Clustered Index Scan,OBJECT:([northwind].[dbo].[producthistory].[pk_product_history] AS [t]),"[t].[categoryid], [t].[unitprice]",2310000,18.71646,0.63528925,20,19.351748,"[t].[categoryid], [t].[unitprice]",,PLAN_ROW,true,1
                                |--Clustered Index Scan(OBJECT:([northwind].[dbo].[producthistory].[pk_product_history])),1,20,16,Clustered Index Scan,Clustered Index Scan,OBJECT:([northwind].[dbo].[producthistory].[pk_product_history]),"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice]",2310000,18.71646,0.63528925,52,19.351748,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice]",,PLAN_ROW,true,1

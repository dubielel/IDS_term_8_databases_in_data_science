StmtText,StmtId,NodeId,Parent,PhysicalOp,LogicalOp,Argument,DefinedValues,EstimateRows,EstimateIO,EstimateCPU,AvgRowSize,TotalSubtreeCost,OutputList,Warnings,Type,Parallel,EstimateExecutions
"with t as (
    select
        id,
        productid,
        productname,
        categoryid,
        unitprice,
        avg(unitprice) over (PARTITION BY categoryid) as avgprice
    from producthistory
)

select * from t
where t.unitprice > t.avgprice",1,1,0,,,1,,693000,,,,44.668606,,,SELECT,false,
  |--Parallelism(Gather Streams),1,2,1,Parallelism,Gather Streams,,,693000,0,1.4648292,69,44.668606,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1002]",,PLAN_ROW,true,1
       |--Filter(WHERE:([northwind].[dbo].[producthistory].[unitprice]>[Expr1002])),1,3,2,Filter,Filter,WHERE:([northwind].[dbo].[producthistory].[unitprice]>[Expr1002]),,693000,0,0.2772,69,43.20274,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1002]",,PLAN_ROW,true,1
"            |--Compute Scalar(DEFINE:([Expr1002]=CASE WHEN [Expr1003]=(0) THEN NULL ELSE [Expr1004]/CONVERT_IMPLICIT(decimal(19,0),[Expr1003],0) END))",1,4,3,Compute Scalar,Compute Scalar,"DEFINE:([Expr1002]=CASE WHEN [Expr1003]=(0) THEN NULL ELSE [Expr1004]/CONVERT_IMPLICIT(decimal(19,0),[Expr1003],0) END)","[Expr1002]=CASE WHEN [Expr1003]=(0) THEN NULL ELSE [Expr1004]/CONVERT_IMPLICIT(decimal(19,0),[Expr1003],0) END",2310000,0,0,68,42.925537,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1002]",,PLAN_ROW,true,1
"                 |--Window Aggregate(DEFINE:([Expr1003]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice]), [Expr1004]=SUM([northwind].[dbo].[producthistory].[unitprice])), PARTITION COLUMNS:([northwind].[dbo].[producthistory].[categoryid]), RANGE BETWEEN:(UNBOUNDED, UNBOUNDED))",1,5,4,Window Aggregate,Window Aggregate,"DEFINE:([Expr1003]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice]), [Expr1004]=SUM([northwind].[dbo].[producthistory].[unitprice])), PARTITION COLUMNS:([northwind].[dbo].[producthistory].[categoryid]), RANGE BETWEEN:(UNBOUNDED, UNBOUNDED)","[Expr1003]=COUNT_BIG([northwind].[dbo].[producthistory].[unitprice]), [Expr1004]=SUM([northwind].[dbo].[producthistory].[unitprice])",2310000,0,0.181335,68,42.925537,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice], [Expr1003], [Expr1004]",,PLAN_ROW,true,1
                      |--Sort(ORDER BY:([northwind].[dbo].[producthistory].[categoryid] ASC)),1,6,5,Sort,Sort,ORDER BY:([northwind].[dbo].[producthistory].[categoryid] ASC),,2310000,21.047297,2.3451586,52,42.7442,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice]",,PLAN_ROW,true,1
                           |--Clustered Index Scan(OBJECT:([northwind].[dbo].[producthistory].[pk_product_history])),1,7,6,Clustered Index Scan,Clustered Index Scan,OBJECT:([northwind].[dbo].[producthistory].[pk_product_history]),"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice]",2310000,18.71646,0.63528925,52,19.351748,"[northwind].[dbo].[producthistory].[id], [northwind].[dbo].[producthistory].[productid], [northwind].[dbo].[producthistory].[productname], [northwind].[dbo].[producthistory].[categoryid], [northwind].[dbo].[producthistory].[unitprice]",,PLAN_ROW,true,1
